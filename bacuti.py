# -*- coding: utf-8 -*-
"""Untitled19.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1U04ByvqK9wIhR7i1Ugcl0Fbcr8dk2FWR
"""

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_squared_error
import numpy as np

# Load the datasets
train_df = pd.read_csv('/content/train.csv')
test_df = pd.read_csv('/content/test.csv')

# Display the first few rows of the train and test datasets
print("Training Data:")
print(train_df.head())
print("\nTesting Data:")
print(test_df.head())

# Data Preprocessing
# Extract features and target variable from the training data
X_train = train_df.drop(columns=['ID', 'date', 'appliances'])
y_train = train_df['appliances']

# Prepare the test data
X_test = test_df.drop(columns=['ID', 'date'])

# Train a Random Forest Regressor
model = RandomForestRegressor(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# Make predictions on the test set
predictions = model.predict(X_test)

# For illustration purposes, split the train data for validation
X_train_split, X_valid_split, y_train_split, y_valid_split = train_test_split(X_train, y_train, test_size=0.2, random_state=42)
model.fit(X_train_split, y_train_split)
valid_predictions = model.predict(X_valid_split)

# Calculate RMSE on validation set
rmse = np.sqrt(mean_squared_error(y_valid_split, valid_predictions))
print(f"Validation RMSE: {rmse}")

# Save the predictions to a CSV file
output_df = test_df[['ID']].copy()
output_df['appliances'] = predictions
output_df.to_csv('predictions.csv', index=False)

print("Predictions saved to predictions.csv")

# Recommendations for reducing energy consumption
# Here, the recommendations are generalized based on typical energy-saving practices

#recommendations = """
#1. Improve insulation in the household to reduce heating and cooling needs.
#2. Use energy-efficient appliances and lighting.
#3. Implement programmable thermostats to optimize heating and cooling.
#4. Regularly maintain HVAC systems to ensure they are running efficiently.
#5. Encourage behavior changes such as turning off lights and appliances when not in use.
#6. Install solar panels or other renewable energy sources to offset energy consumption.
#"""

#print(recommendations)

